<app-layout>
  <div class="container">
    <div>
      <h1>üé® Galer√≠a</h1>
      <p>
        Aqu√≠ est√°n algunos de mis dibujos e ilustraciones p√∫blicas.
        <strong>Pulsa en cualquiera de ellos para ver los detalles</strong>.
      </p>
    </div>

    <form
      [formGroup]="filterForm"
      (submit)="submitFilter()"
      id="formFilter"
      asp-action="Filter"
      asp-controller="Art"
      data-ajax="true"
      data-ajax-method="POST"
      data-ajax-begin="onBeginFilter"
      data-ajax-failure="onFailureFilter"
      data-ajax-success="onSuccessFilter"
      data-ajax-complete="onCompleteFilter">
      <div class="row">
        <div class="mr-sort-filter-container" data-bs-theme="dark">
          <div class="mr-sort-filter">
            <span> Ordenar por... </span>
            <select
              id="sFilterSortBy"
              class="mr-custom-select filters form-select form-select-sm"
              formControlName="sortBy"
              aria-label="Default select example"
              data-bs-theme="dark"
              (change)="submitFilter()"
              data-bs-theme="dark">
              <option value="date-desc">Nuevos Primero</option>
              <option value="date-asc">Viejos Primero</option>
              <option value="name-asc">Nombre (Ascendente)</option>
              <option value="name-desc">Nombre (Descendente)</option>
              <option value="time-asc">M√°s R√°pidos</option>
              <option value="time-desc">M√°s Largos</option>
              <option value="kudos-desc" class="kudos">M√°s Kudos</option>
              <option value="kudos-asc" class="kudos">Menos Kudos</option>
              <option value="views-desc" class="views">M√°s Vistos</option>
              <option value="views-asc" class="views">Menos Vistos</option>
              <option value="scorem-desc" class="mr-score-miguel">
                Mejor Puntuaci√≥n
              </option>
              <option value="scorem-asc" class="mr-score-miguel">
                Peor Puntuaci√≥n
              </option>
              <option value="scoreu-desc" class="mr-score-popular">
                Mejor Puntuaci√≥n Popular
              </option>
              <option value="scoreu-asc" class="mr-score-popular">
                Peor Puntuaci√≥n Popular
              </option>
            </select>
          </div>
        </div>
      </div>

      <div class="row">
        <div
          id="formFilterAlert"
          class="alert alert-danger"
          style="display: none"
          role="alert"></div>

        <span class="mr-suboption-filter"> Filtrar por... </span>
        <div class="mr-filter-container">
          <button class="btn btn-dark mr-custom-btn" (click)="resetFilters()">
            <span><i id="iFavoriteIcon" class="bi bi-trash"></i></span>
          </button>

          <input
            id="tbTags"
            formControlName="textQuery"
            class="form-control mr-custom-text mr-filter-item"
            type="text"
            placeholder="Buscar por nombre, modelo, producto, etc."
            (change)="submitFilter()"
            (keydown)="capturarEnter($event)" />

          <select
            id="sFilterType"
            *ngIf="listDrawingStyles.length > 0"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            formControlName="type"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="-1" selected>üñå ESTILO</option>
            <option *ngFor="let style of listDrawingStyles" [value]="style.id">
              {{ style.translatedText }}
            </option>
            <option value="0">(Otro Estilo)</option>
          </select>

          <select
            id="sFilterProduct"
            *ngIf="listDrawingProductTypes.length > 0"
            formControlName="productType"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="-1" selected>üì∫ TIPO</option>

            <option
              *ngFor="let type of listDrawingProductTypes"
              [value]="type.id">
              {{ type.emoji }} {{ type.translatedText }}
            </option>
            <option value="0">(Otro Tipo)</option>
          </select>

          <select
            id="sFilterProductName"
            *ngIf="listDrawingProducts.length > 0"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            formControlName="productName"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="" selected>üñº TEM√ÅTICA</option>

            <option
              *ngFor="let product of listDrawingProducts"
              [value]="product.productName">
              {{ getEmojiFromProductType(product.productTypeId) }}
              {{ product.productName }}
            </option>

            <option value="none">(Ninguna Tem√°tica)</option>
          </select>

          <select
            id="sFilterCollection"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            *ngIf="listCollections.length > 0"
            formControlName="collection"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="" selected>ü§© COLECCI√ìN</option>

            <option [value]="col.id" *ngFor="let col of listCollections">
              {{ col.name }}
            </option>
          </select>

          <select
            id="sFilterCharacterName"
            *ngIf="listDrawingCharacters.length > 0"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            formControlName="characterName"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="" selected>üò∫ PERSONAJE</option>

            <option
              *ngFor="let character of listDrawingCharacters"
              [value]="character.characterName">
              {{ getEmojiFromProductType(character.productTypeId) }}
              {{ character.characterName }}
            </option>

            <option value="none">(Ning√∫n Personaje)</option>
          </select>

          <select
            id="sFilterModel"
            *ngIf="listDrawingModels.length > 0"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            formControlName="modelName"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="" selected>üë© MODELO</option>

            <option *ngFor="let model of listDrawingModels" [value]="model">
              {{ model }}
            </option>

            <option value="none">(Ning√∫n Modelo)</option>
          </select>

          <select
            id="sFilterSoftware"
            *ngIf="listDrawingSoftwares.length > 0"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            formControlName="software"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="0" selected>üíª SOFTWARE</option>

            <option *ngFor="let sw of listDrawingSoftwares" [value]="sw.id">
              {{ sw.name }}
            </option>
          </select>

          <select
            id="sFilterPaper"
            *ngIf="listDrawingPapers.length > 0"
            class="mr-custom-select form-select form-select-sm mr-filter-item"
            formControlName="paper"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="0" selected>üìÑ TAMA√ëO</option>

            <option *ngFor="let paper of listDrawingPapers" [value]="paper.id">
              {{ paper.name }}
            </option>
          </select>

          <select
            id="sFilterSpotify"
            class="mr-custom-select form-select form-select-sm mr-filter-item mr-spotify"
            formControlName="formSpotify"
            data-bs-theme="dark"
            (change)="submitFilter()">
            <option value="null" selected>üéµ M√öSICA</option>
            <option value="true">Pista de Spotify Sugerida</option>
            <option value="false">Sin pista sugerida</option>
          </select>

          <div class="mr-choice-filter mr-filter-item">
            <label
              class="form-check-label choice-label"
              for="flexSwitchCheckChecked"
              style="font-weight: bold"
              >‚≠ê FAVORITOS</label
            >
            <input
              class="form-check-input"
              formControlName="formFavorites"
              type="checkbox"
              role="switch"
              value="true"
              id="flexSwitchCheckChecked"
              (change)="submitFilter()" />
          </div>
        </div>
      </div>
    </form>
    <div class="row mt-2" style="padding-bottom: 20px">
      <div class="mr-loader-container">
        <div id="divImageCounter" class="slide-right">
          <span class="mr-suboption-filter">
            <span id="spResultsCount">{{ listDrawings?.length || 0 }}</span>
            <span id="spTextoImagenes">im√°genes</span
            ><span id="spTextoImagen" style="display: none">imagen</span>
          </span>
        </div>
        <div id="artGalleryLoader" class="mr-loader" *ngIf="filterFormLoading">
          <img
            alt="Loading"
            src=" assets/pacman-loading.svg"
            class="mr-loading-icon-pacman" />
          <span class="mr-loader-subtitle"
            >Filtrando im√°genes. Por favor, espere.</span
          >
        </div>
        <div id="artGallery" class="mr-img-gallery">
          <app-drawing-thumbnail
            [drawing]="drawing"
            *ngFor="let drawing of listDrawings">
          </app-drawing-thumbnail>
        </div>
        <!-- TODO: resolver porqu√© no se esconde esto -->
        <div id="divNoResults" *ngIf="resultsNotFound">
          <span> ¬°Nada por aqu√≠..! </span>
          <h2>üòî</h2>
          <span> Vuelve a intentarlo utilizando otros filtros. </span>
        </div>
      </div>
    </div>
  </div>
</app-layout>
